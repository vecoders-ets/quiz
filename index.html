<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Cyber Quiz</title>
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Courier New', monospace;
      color: #00ff00; /* green cyber color */
      background: #0a0a0f;
      height: 100vh;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    video.bg-video {
      position: fixed;
      right: 0;
      bottom: 0;
      min-width: 100%;
      min-height: 100%;
      object-fit: cover;
      z-index: -1;
      filter: brightness(0.4) contrast(1.2);
    }

    .container {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 40px;
      position: relative;
      z-index: 2;
    }

    .form-screen, .questionnaire, .thank-you {
      background: rgba(20,20,30,0.85);
      padding: 30px;
      border-radius: 12px;
      max-width: 650px;
      width: 100%;
      text-align: center;
      border: 2px solid #00ff00;
      box-shadow: 0 0 20px #00ff00;
      animation: glow 2s infinite alternate;
    }

    @keyframes glow {
      from { box-shadow: 0 0 8px #00ff00; }
      to { box-shadow: 0 0 20px #00ff00; }
    }

    h1 {
      color: #00ff00;
      font-size: 2rem;
      margin-bottom: 20px;
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    h2 { color: #00ff00; text-transform: uppercase; letter-spacing: 2px; }

    input, button {
      width: 100%;
      padding: 14px;
      margin: 12px 0;
      border: 1px solid #00ff00;
      border-radius: 8px;
      font-size: 1rem;
      font-family: 'Courier New', monospace;
      background: black;
      color: #00ff00;
      outline: none;
    }

    input::placeholder { color: #0f0; }

    button {
      background-color: #111;
      border: 2px solid #00ff00;
      cursor: pointer;
      text-transform: uppercase;
      letter-spacing: 1px;
      font-weight: bold;
      transition: all 0.3s ease;
    }

    button:hover { background-color: #00ff00; color: #000; box-shadow: 0 0 15px #00ff00; }
    .next-btn:disabled { background: #222; border-color: #555; color: #777; }

    .question-count {
      color: #00ff00;
      font-weight: bold;
      margin-bottom: 0.5rem;
      font-size: 1rem;
      letter-spacing: 1px;
    }

    .question-text {
      font-size: 1.2rem;
      font-weight: bold;
      margin-bottom: 20px;
      color: #fff;
      text-shadow: 0 0 8px #00ff00;
    }

    .options button {
      display: block;
      width: 100%;
      padding: 14px;
      font-size: 1rem;
      border-radius: 10px;
      background: #111;
      margin-bottom: 12px;
      text-align: left;
      cursor: pointer;
      border: 1px solid #00ff00;
      color: #00ff00;
      transition: background 0.3s ease, box-shadow 0.3s ease;
    }

    .options button:hover { background-color: #00ff00; color: #000; }
    .options button.selected { background-color: #00ff00; color: #000; box-shadow: 0 0 10px #00ff00; }

    /* Result styles */
    #thank-you #result-text {
      font-size: 1.5rem; /* smaller score above */
      margin-bottom: 15px;
      color: #00ff00;
    }

    #thank-you #result-message {
      font-size: 3rem; /* big message */
      font-weight: bold;
      text-align: center;
      color: #00ff00;
      margin-bottom: 20px;
    }

    #clues-list {
      text-align: left;
      font-size: 1rem; /* smaller font for clues */
      color: #00ff00;
      line-height: 1.6;
      margin-top: 20px;
    }

    #clues-list li {
      margin-bottom: 10px;
    }

    /* Final key box styling */
    #final-key-box {
      margin-top: 20px;
      text-align: left;
    }

    #final-key-box input {
      width: calc(100% - 110px);
      display: inline-block;
      vertical-align: middle;
      margin-right: 8px;
    }

    #final-key-box button {
      width: 100px;
      display: inline-block;
      vertical-align: middle;
      padding: 12px;
      margin: 0;
    }

    #finalKeyMsg {
      margin-top: 12px;
      font-size: 1rem;
      color: #00ff00;
    }
  </style>
</head>
<body>
  <video class="bg-video" src="./vid/vid.mp4" autoplay muted loop></video>

  <div class="container">
    <!-- Form -->
    <div class="form-screen" id="form-screen">
      <h1>Solve the Quiz â€“ Last Round</h1>
      <input type="text" id="teamName" placeholder="Team Name" required />
      <input type="email" id="email" placeholder="Email" required />
      <button onclick="startQuiz()">Start Quiz</button>
      <div id="form-error" style="color:red; margin-top:10px;"></div>
    </div>

    <!-- Quiz -->
    <div class="questionnaire" id="questionnaire" style="display:none;">
      <div class="question-count" id="question-count">Question 1/10</div>
      <div class="question-text" id="question-text"></div>
      <div class="options" id="options"></div>
      <button class="next-btn" id="next-btn" disabled>Next â†’</button>
    </div>

    <!-- Result -->
    <div class="thank-you" id="thank-you" style="display:none;">
      <div id="result-text"></div>
      <div id="result-message"></div>
      <ul id="clues-list"></ul>

      <!-- Final key input - shown only when clues unlocked -->
      <div id="final-key-box" style="display:none;">
        <input type="text" id="finalKeyInput" placeholder="Enter the final key" />
        <button id="finalKeySubmit" onclick="checkFinalKey()">Submit</button>
        <div id="finalKeyMsg"></div>
      </div>
    </div>
  </div>

  <script>
    const questions = [
      { text: "1. What will be the output of this Python code?\n\nlist1 = [1,2,3]\nlist2 = list1\nlist2.append(4)\nprint(list1)", options: ["a) [1, 2, 3]","b) [1, 2, 3, 4]","c) Error","d) None"], answer:"b) [1, 2, 3, 4]" },
      { text: "2. In C, output of:\nint a=5; printf(\"%d %d %d\", a, a++, ++a);", options: ["a) 5 6 7","b) 7 6 6","c) Undefined behavior","d) 5 5 5"], answer:"c) Undefined behavior" },
      { text: "3. Which SQL command removes a table permanently?", options: ["a) DELETE","b) DROP","c) TRUNCATE","d) REMOVE"], answer:"b) DROP" },
      { text: "4. What will this Java code print?\n\nString s1=\"hello\";\nString s2=\"he\"+\"llo\";\nSystem.out.println(s1==s2);", options: ["a) true","b) false","c) Compilation error","d) Depends on JVM"], answer:"a) true" },
      { text: "5. In OS, which is not a page replacement algorithm?", options: ["a) LRU","b) Optimal","c) MRU","d) SJF"], answer:"d) SJF" },
      { text: "6. Which is NOT a characteristic of OOP?", options: ["a) Inheritance","b) Encapsulation","c) Polymorphism","d) Modularity in Assembly Code"], answer:"d) Modularity in Assembly Code" },
      { text: "7. Python output?\n\na=[1,2,3,4]\nprint(a[-2::-1])", options: ["a) [3,2,1]","b) [4,3,2]","c) [3,2]","d) [2,1]"], answer:"a) [3,2,1]" },
      { text: "8. In SQL, which ensures all values unique & not NULL?", options: ["a) PRIMARY KEY","b) UNIQUE","c) FOREIGN KEY","d) CHECK"], answer:"a) PRIMARY KEY" },
      { text: "9. Which protocol is secure?", options: ["a) HTTP","b) HTTPS","c) FTP","d) SMTP"], answer:"b) HTTPS" },
      { text: "10. Which OS statement is TRUE?", options: ["a) Deadlock occurs when no shared resources","b) Semaphore solves sync problems","c) Thrashing when CPU overloaded","d) Virtual memory decreases space"], answer:"b) Semaphore solves sync problems" }
    ];

    let currentQuestion = 0;
    let score = 0;
    let teamName = "", email = "";
    const questionText = document.getElementById('question-text');
    const optionsContainer = document.getElementById('options');
    const nextBtn = document.getElementById('next-btn');
    const questionCount = document.getElementById('question-count');
    const scoreMap = {};

    function loadQuestion() {
      const q = questions[currentQuestion];
      questionCount.innerText = `Question ${currentQuestion + 1}/${questions.length}`;
      questionText.innerText = q.text;
      optionsContainer.innerHTML = '';
      nextBtn.disabled = true;

      q.options.forEach(option => {
        const btn = document.createElement('button');
        btn.innerText = option;
        btn.onclick = () => {
          document.querySelectorAll('.options button').forEach(b => b.classList.remove('selected'));
          btn.classList.add('selected');
          nextBtn.disabled = false;
          scoreMap[currentQuestion] = option === q.answer;
        };
        optionsContainer.appendChild(btn);
      });
    }

    nextBtn.onclick = () => {
      if (currentQuestion < questions.length - 1) {
        currentQuestion++;
        loadQuestion();
      } else {
        finishQuiz();
      }
    };

    function startQuiz() {
      teamName = document.getElementById('teamName').value.trim();
      email = document.getElementById('email').value.trim();
      const errorDiv = document.getElementById('form-error');
      if (!teamName || !email) {
        errorDiv.textContent = "âš  Access Denied: Missing Credentials";
        return;
      }
      document.getElementById('form-screen').style.display = 'none';
      document.getElementById('questionnaire').style.display = 'block';
      loadQuestion();
    }

    async function finishQuiz() {
      document.getElementById('questionnaire').style.display = 'none';
      const thankYouDiv = document.getElementById('thank-you');
      score = Object.values(scoreMap).filter(Boolean).length;
      document.getElementById('result-text').innerText = `Score: ${score}/10`;

      const cluesList = document.getElementById('clues-list');
      cluesList.innerHTML = "";

      const finalKeyBox = document.getElementById('final-key-box');
      const finalKeyMsg = document.getElementById('finalKeyMsg');
      finalKeyMsg.innerText = "";
      document.getElementById('finalKeyInput').value = "";

      if (score >= 7) {
        document.getElementById('result-message').innerText = "ðŸŸ¢ Clues Unlocked!";
        const clues = [
          "(1) I wait by the steps, painted bright red. In danger I scream, but now hide instead.",
          "(2) I stand tall and ready, though never I shout. When flames appear, I help put them out.",
          "(3) Iâ€™m blue in color, I hold water tight. Find me in the hall where the crowd is in sight.",
          "(4) Iâ€™m white and wide, where lessons are told. Check behind me, a secret I hold."
        ];
        clues.forEach(clue => {
          const li = document.createElement('li');
          li.innerText = clue;
          cluesList.appendChild(li);
        });

        // show final key input box when clues unlocked
        finalKeyBox.style.display = 'block';
      } else {
        document.getElementById('result-message').innerText = "ðŸ”´ Youâ€™re Eliminated!";
        finalKeyBox.style.display = 'none';
      }

      try {
        const formData = new URLSearchParams();
        formData.append("Timestamp", new Date().toLocaleString());
        formData.append("Team Name", teamName);
        formData.append("Email", email);
        formData.append("Score", score);

        const scriptURL = "https://script.google.com/macros/s/AKfycbwavpDRD7ttglCIjQjkS-LeSZGM0GlK7PEwYvCInFvwJ7MxfMeqytMvFPwH9MZJkps7/exec";
        await fetch(scriptURL, { method: "POST", body: formData });
      } catch (err) {
        console.error("Submission error:", err);
      }
      thankYouDiv.style.display = 'block';
    }

    function checkFinalKey() {
      const input = document.getElementById('finalKeyInput');
      const key = input.value.trim();
      const msgDiv = document.getElementById('finalKeyMsg');

      const keyMap = {
        "890907": "ironman4mark85@gmail.com",
        "398976": "captainamerica4shield@gmail.com",
        "137387": "thor4mjolnir@gmail.com",
        "798435": "hulk4incredible@gmail.com"
      };

      if (keyMap[key]) {
        msgDiv.style.color = "#00ff00";
        msgDiv.innerText = keyMap[key];
      } else {
        msgDiv.style.color = "red";
        msgDiv.innerText = "You failed, retry.";
      }
    }
  </script>
</body>
</html>
